<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
</head>

<body>
  <p>STLファイルを読み込んで、3DをCamvasで表示</p>
  <script src="./threejs/three.min.js"></script>
  <script src="./threejs/examples/js/loaders/STLLoader.js"></script>
  <script src="./threejs/examples/js/renderers/CanvasRenderer.js"></script>
  <script src="./threejs/examples/js/renderers/Projector.js"></script>
  <script src="./threejs/examples/js/controls/TrackballControls.js"></script>
  <script>
    var APP = {};

    APP.animate = function() {
      APP.renderer.render(APP.scene, APP.camera);
      APP.controls.update();
      requestAnimationFrame(APP.animate);
    };

    $(document).ready(function() {

      // Rendererを用意
      APP.renderer = new THREE.CanvasRenderer();
      APP.renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(APP.renderer.domElement);

      // Cameraを用意
      APP.camera = new THREE.PerspectiveCamera();
      APP.camera.position.z = 100;

      // Sceneを用意
      APP.scene = new THREE.Scene();
      APP.scene.add(APP.camera);

      //ライトを用意
      var directionalLight = new THREE.DirectionalLight(0xffffff, 3);
      directionalLight.position.y = 10;
      directionalLight.position.z = 10;
      APP.scene.add(directionalLight);
      var aLight = new THREE.AmbientLight(0xffffff);
      APP.scene.add(aLight);

      //3Dを用意
      var loader = new THREE.STLLoader();
      loader.load('openjscad.stl', function(geometry) {
        var material = new THREE.MeshLambertMaterial({
          ambient: 0xff5533,
          color: 0xff5533
        });
        mesh = new THREE.Mesh(geometry, material);
        APP.scene.add(mesh);

        // Controlsを用意
        APP.controls = new THREE.TrackballControls(APP.camera);
        APP.animate();
      });
    });
  </script>
</body>

</html>